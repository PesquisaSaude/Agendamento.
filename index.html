<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agendamento de Empresa SESI</title>

  <style>
    /* ======= GERAL ======= */
    body {
      font-family: "Inter", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #e6f0fa, #f5f9ff);
      padding: 40px;
      margin: 0;
      color: #1e2a44;
      line-height: 1.6;
    }

    /* ======= TÍTULO ======= */
    .header-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 40px;
      gap: 20px;
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .header-logo {
      width: 200px;
      height: auto;
      transition: transform 0.3s ease;
    }

    .header-logo:hover {
      transform: scale(1.05);
    }

    h2 {
      color: #0a3d62;
      font-size: 34px;
      font-weight: 700;
      margin: 0;
      text-align: left;
      background: linear-gradient(to right, #0a3d62, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* ======= CONTAINER PRINCIPAL ======= */
    .container {
      max-width: 1600px;
      margin: auto;
      background: #ffffff;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease;
    }

    .container:hover {
      transform: translateY(-4px);
    }

    /* ======= FORMULÁRIOS ======= */
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 8px;
      font-size: 16px;
      color: #0a3d62;
      position: relative;
    }

    label::before {
      content: "•";
      color: #3b82f6;
      margin-right: 8px;
      font-size: 14px;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid #d1d9e6;
      font-size: 15px;
      background-color: #f8fafc;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
      background-color: #ffffff;
      outline: none;
    }

    /* ======= INPUTS EM LINHA ======= */
    .inline-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
      padding: 20px;
      background: #f1f5f9;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }

    /* ======= LINHAS EM FLEX ======= */
    .row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      background-color: #f1f5f9;
      padding: 24px;
      border-radius: 12px;
      margin-top: 30px;
      border: 1px solid #d1e9ff;
      transition: background-color 0.3s ease;
    }

    .row:hover {
      background-color: #e8f0fe;
    }

    /* ======= CAIXAS DE INFORMAÇÃO ======= */
    .resumo,
    .empresa-info,
    .trabalhador-info,
    .form-admissional {
      margin-top: 40px;
      padding: 24px;
      background: #ffffff;
      border-radius: 12px;
      border-left: 6px solid #3b82f6;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
      display: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .resumo.show,
    .empresa-info.show,
    .trabalhador-info.show,
    .form-admissional.show {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    #resumo {
      background: #eff6ff;
    }

    #lista-agendamentos .resumo {
      margin-top: 30px;
    }

    .excluir-agendamento-btn {
      background: linear-gradient(to right, #ef4444, #dc2626);
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin-top: 12px;
      transition: all 0.3s ease;
    }

    .excluir-agendamento-btn:hover {
      background: linear-gradient(to right, #dc2626, #b91c1c);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
    }

    /* ======= BOTÕES ======= */
    .button-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-top: 40px;
    }

    button {
      background: linear-gradient(to right, #0a3d62, #3b82f6);
      color: white;
      padding: 16px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    button:hover {
      background: linear-gradient(to right, #083152, #2563eb);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(59, 130, 246, 0.3);
    }

    button::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.4s ease, height 0.4s ease;
    }

    button:hover::after {
      width: 200px;
      height: 200px;
    }

    /* ======= LOGO CORAÇÃO ======= */
    .logo-coracao {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 150px;
      height: auto;
      z-index: 1000;
      filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
      transition: transform 0.3s ease;
    }

    .logo-coracao:hover {
      transform: rotate(10deg);
    }

    /* ======= RESPONSIVO ======= */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }

      .container {
        padding: 24px;
      }

      .header-container {
        flex-direction: column;
        gap: 12px;
        padding: 16px;
      }

      h2 {
        font-size: 28px;
        text-align: center;
      }

      .header-logo {
        width: 80px;
      }

      .inline-group,
      .row {
        grid-template-columns: 1fr;
        padding: 16px;
      }

      button {
        font-size: 15px;
        padding: 14px;
      }

      .logo-coracao {
        width: 100px;
        top: 10px;
        right: 10px;
      }
    }

    /* ======= ESTILOS PARA IMPRESSÃO ======= */
    @media print {
      body {
        background: none;
        padding: 0;
      }

      .container {
        box-shadow: none;
        padding: 20px;
        margin: 0;
      }

      .logo-coracao,
      #tipo-identificacao,
      #campo-cnpj,
      #campo-cei,
      #tipo-agendamento,
      #area-cpf,
      #form-admissional,
      #observacoes,
      .row,
      #tipo-atendimento,
      .button-container,
      #trabalhador-info,
      #temp-pdf-content {
        display: none !important;
      }

      .header-container {
        display: flex !important;
        align-items: center;
        justify-content: flex-start;
        margin-bottom: 20px;
      }

      .header-logo {
        display: block !important;
        width: 80px;
      }

      h2 {
        display: block !important;
        font-size: 24px;
        border: none;
        text-align: left;
        -webkit-text-fill-color: #0a3d62;
      }

      #resumo,
      #lista-agendamentos .resumo {
        display: block !important;
        margin: 10px 0;
        border: none;
        box-shadow: none;
        background: none;
        padding: 10px;
      }

      #empresa-info {
        display: block !important;
        margin: 10px 0;
      }

      .excluir-agendamento-btn {
        display: none !important;
      }
    }

    /* Estilo para a seção de trabalhador e exames com borda divisória */
    .trabalhador-info .dados-trabalhador {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      padding-bottom: 20px;
      border-bottom: 2px solid #3b82f6;
      margin-bottom: 20px;
    }

    .trabalhador-info .exames-ocupacionais {
      flex: 1 1 100%;
    }

    .trabalhador-info .exames-ocupacionais strong {
      font-weight: 700;
      color: #0a3d62;
    }

    /* Estilo para a seção de informações da empresa */
    .empresa-info .empresa-dados {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      background: #f8fafc;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #d1e9ff;
      align-items: center;
      font-size: 15px;
    }

    .empresa-info .empresa-dados strong {
      color: #0a3d62;
      margin-right: 6px;
    }

    .empresa-info .empresa-dados span {
      color: #1e2a44;
      font-weight: 500;
    }

    /* Estilo para o resumo do agendamento */
    .resumo {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      background: #eff6ff;
      padding: 24px;
      border-radius: 12px;
      border: 1px solid #d1e9ff;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    }

    .resumo .section {
      padding: 16px;
      background: #ffffff;
      border-radius: 10px;
      border: 1px solid #e2e8f0;
      transition: transform 0.3s ease;
    }

    .resumo .section:hover {
      transform: translateY(-4px);
    }

    .resumo .section h4 {
      margin: 0 0 12px 0;
      color: #0a3d62;
      font-size: 18px;
      border-bottom: 2px solid #3b82f6;
      padding-bottom: 8px;
    }

    .resumo .section p {
      margin: 6px 0;
      font-size: 14px;
      color: #1e2a44;
    }

    .resumo .section p strong {
      color: #0a3d62;
    }

    /* Estilo para o elemento temporário do PDF */
    #temp-pdf-content {
      position: absolute;
      top: -9999px;
      left: -9999px;
      width: 100%;
      max-width: 800px;
      background: #ffffff;
      padding: 20px;
      box-sizing: border-box;
    }

    #temp-pdf-content .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    #temp-pdf-content .header img {
      width: 120px;
      height: auto;
    }
  </style>
</head>
<body>
  <img src="img/coracao.gif" alt="Logo do coração" class="logo-coracao">

  <div class="container">
    <div class="header-container">
      <img src="img/sesi.jpg" alt="Logo do SESI" class="header-logo">
      <h2>Agendamento Empresas SESI Saúde</h2>
    </div>

    <label for="tipo-identificacao">Tipo de Identificação:</label>
    <select id="tipo-identificacao" onchange="mostrarCampoIdentificacao()" style="width: 200px;">
      <option value="">Selecione</option>
      <option value="cnpj">CNPJ</option>
      <option value="cei">CEI</option>
    </select>

    <div id="campo-cnpj" style="display: none;">
      <label for="cnpj">CNPJ da Empresa:</label>
      <input type="text" id="cnpj" placeholder="Digite o CNPJ" onblur="buscarEmpresa()" style="width: 200px;" />
    </div>

    <div id="campo-cei" style="display: none;">
      <label for="cei">CEI da Empresa:</label>
      <input type="text" id="cei" placeholder="Digite o CEI" style="width: 150px;">
    </div>

    <div class="empresa-info" id="empresa-info"></div>

    <label for="tipo-agendamento">Tipo de Agendamento:</label>
    <select id="tipo-agendamento" onchange="verificarTipoAgendamento()" style="width: 200px;">
      <option value="">Selecione</option>
      <option value="Admissional">Admissional</option>
      <option value="Demissional">Demissional</option>
      <option value="Periódico">Periódico</option>
      <option value="Retorno ao Trabalho">Retorno ao Trabalho</option>
      <option value="Atendimento Pontual">Atendimento Pontual</option>
    </select>

    <div id="area-cpf">
      <label for="cpf">CPF do Trabalhador:</label>
      <input type="text" id="cpf" placeholder="Digite o CPF" onblur="buscarTrabalhador()" style="width: 150px;" />
    </div>

    <div class="form-admissional" id="form-admissional">
      <label for="nome">Nome Completo:</label>
      <input type="text" id="nome" />

      <label for="cpf-admissional">CPF:</label>
      <input type="text" id="cpf-admissional" />

      <label for="nascimento">Data de Nascimento:</label>
      <input type="date" id="nascimento" />

      <label for="rg">RG:</label>
      <input type="text" id="rg" />

      <label for="setor">Setor:</label>
      <input type="text" id="setor" />

      <label for="funcao">Função:</label>
      <input type="text" id="funcao" />
    </div>

    <div class="trabalhador-info" id="trabalhador-info"></div>

    <div style="text-align: right; margin-top: 10px;">
      <label for="observacoes"><strong>Observações:</strong></label><br />
      <textarea id="observacoes" rows="2" cols="30" style="width: 500px; height: 100px;" placeholder="Digite observações aqui..."></textarea>
    </div>

    <label>Data e Horário do Agendamento:</label>
    <div class="row">
      <div>
        <label for="data">Data:</label>
        <input type="date" id="data" class="input-agendamento" />
      </div>
      <div>
        <label for="hora">Horário:</label>
        <input type="time" id="hora" class="input-agendamento" />
      </div>
      <div>
        <label for="contatoTipo">Contato do Trabalhador:</label>
        <select id="contatoTipo" onchange="mostrarCampoContato()">
          <option value="">Escolha</option>
          <option value="telefone">Telefone</option>
          <option value="email">E-mail</option>
        </select>
        <input type="text" id="contato" class="input-agendamento" style="margin-top: 5px; display: none;" />
      </div>
    </div>

    <label for="tipo-atendimento">Tipo de Atendimento:</label>
    <select id="tipo-atendimento">
      <option value="">Selecione</option>
      <option value="ASO e Exames Complementares">ASO e Exames Complementares</option>
      <option value="Apenas ASO">Apenas ASO</option>
      <option value="Apenas Exames Complementares">Apenas Exames Complementares</option>
      <option value="Atendimento Pontual">Atendimento Pontual</option>
    </select>

    <div class="button-container">
      <button onclick="adicionarNovoAgendamento()">Agendar outro Trabalhador</button>
      <button onclick="confirmarAgendamento()">Confirmar Agendamento</button>
      <button onclick="enviarAgendamento()">Enviar Agendamento</button>
      <button onclick="imprimirAgendamento()">Imprimir/Baixar PDF</button>
    </div>

    <div class="resumo" id="resumo"></div>
    <div id="lista-agendamentos" style="margin-top: 30px;"></div>
    <div id="temp-pdf-content"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script>
    // Função para carregar os agendamentos salvos no localStorage ao carregar a página
    window.onload = function () {
      const savedAgendamentos = localStorage.getItem("listaAgendamentos");
      if (savedAgendamentos) {
        document.getElementById("lista-agendamentos").innerHTML = savedAgendamentos;
      }
    };

    function mostrarCampoIdentificacao() {
      const tipo = document.getElementById("tipo-identificacao").value;
      document.getElementById("campo-cnpj").style.display = tipo === "cnpj" ? "block" : "none";
      document.getElementById("campo-cei").style.display = tipo === "cei" ? "block" : "none";
      document.getElementById("empresa-info").style.display = "none";
    }

    async function buscarEmpresa() {
      const cnpj = document.getElementById("cnpj").value.replace(/\D/g, '');
      const infoDiv = document.getElementById("empresa-info");

      if (cnpj.length !== 14) {
        infoDiv.style.display = "none";
        return;
      }

      try {
        const response = await fetch(`https://publica.cnpj.ws/cnpj/${cnpj}`);
        const data = await response.json();

        if (data.razao_social) {
          infoDiv.innerHTML = `
            <div class="empresa-dados">
              <div>
                <strong>Nome da Empresa:</strong>
                <span>${data.razao_social}</span>
              </div>
              <div>
                <strong>Nome Fantasia:</strong>
                <span>${data.estabelecimento.nome_fantasia || "N/A"}</span>
              </div>
              <div>
                <strong>UF:</strong>
                <span>${data.estabelecimento.estado.sigla}</span>
              </div>
              <div>
                <strong>Cidade:</strong>
                <span>${data.estabelecimento.cidade.nome}</span>
              </div>
            </div>
          `;
          infoDiv.style.backgroundColor = "#cce4ff";
          infoDiv.style.display = "block";
        } else {
          infoDiv.innerHTML = "Empresa não encontrada.";
          infoDiv.style.display = "block";
        }
      } catch (error) {
        infoDiv.innerHTML = "Erro ao consultar o CNPJ.";
        infoDiv.style.display = "block";
      }
    }

    function verificarTipoAgendamento() {
      const tipo = document.getElementById("tipo-agendamento").value;
      document.getElementById("form-admissional").style.display = tipo === "Admissional" ? "block" : "none";
      document.getElementById("area-cpf").style.display = tipo !== "Admissional" ? "block" : "none";
      document.getElementById("trabalhador-info").style.display = "none";
    }

    function buscarTrabalhador() {
      const cpf = document.getElementById("cpf").value.replace(/\D/g, '');
      const div = document.getElementById("trabalhador-info");

      if (cpf.length !== 11) {
        div.style.display = "none";
        return;
      }

      const exames = ["Hemograma", "Raio-X da Face", "Audiometria", "Espirometria", "Acuidade Visual", "EEG", "ECG"];
      const examesHTML = exames.map(exame => `
        <span style="
          background-color: #f8d7da;
          color: #721c24;
          padding: 4px 8px;
          border-radius: 12px;
          margin-right: 6px;
          font-size: 0.9em;
          display: inline-block;
          margin-top: 4px
        ">${exame}</span>`).join('');

      div.innerHTML = `
        <div style="font-family: sans-serif; margin-top: 20px;">
          <div class="dados-trabalhador">
            <div style="display: flex; flex-direction: column;">
              <strong>CPF:</strong>
              <span>${cpf}</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>Nome:</strong>
              <span>João da Silva XPTO</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>Sexo:</strong>
              <span>Masculino</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>RG:</strong>
              <span>1234567</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>Data de Nascimento:</strong>
              <span>01/01/1990</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>Setor:</strong>
              <span>Operacional</span>
            </div>
            <div style="display: flex; flex-direction: column;">
              <strong>Função:</strong>
              <span>Auxiliar Técnico em Refrigeração</span>
            </div>
          </div>
          <div class="exames-ocupacionais">
            <strong>Exames Ocupacionais Necessários:</strong>
            <div>${examesHTML}</div>
          </div>
        </div>
      `;
      div.style.display = "block";
    }

    function mostrarCampoContato() {
      const tipo = document.getElementById("contatoTipo").value;
      const campo = document.getElementById("contato");

      if (tipo === "telefone") {
        campo.style.display = "inline-block";
        campo.placeholder = "(81) 99999-9999";
        campo.type = "tel";
      } else if (tipo === "email") {
        campo.style.display = "inline-block";
        campo.placeholder = "email@exemplo.com";
        campo.type = "email";
      } else {
        campo.style.display = "none";
      }
    }

    function confirmarAgendamento() {
      const divResumo = document.getElementById('resumo');
      const data = document.getElementById("data").value;
      const hora = document.getElementById("hora").value;
      const atendimento = document.getElementById("tipo-atendimento").value;
      const tipoAgendamento = document.getElementById("tipo-agendamento").value;
      const empresaInfo = document.getElementById("empresa-info").innerHTML;
      const observacoes = document.getElementById("observacoes").value;
      const contatoTipo = document.getElementById("contatoTipo").value;
      const contato = document.getElementById("contato").value;
      let trabalhadorInfo = "";

      if (tipoAgendamento === "Admissional") {
        const nome = document.getElementById("nome").value;
        const cpf = document.getElementById("cpf-admissional").value;
        const nascimento = document.getElementById("nascimento").value;
        const rg = document.getElementById("rg").value;
        const setor = document.getElementById("setor").value;
        const funcao = document.getElementById("funcao").value;

        if (!nome || !cpf || !nascimento || !rg || !setor || !funcao) {
          alert("Preencha todos os campos do trabalhador.");
          return;
        }

        trabalhadorInfo = `
          <p><strong>Nome:</strong> ${nome}</p>
          <p><strong>CPF:</strong> ${cpf}</p>
          <p><strong>Data de Nascimento:</strong> ${nascimento}</p>
          <p><strong>RG:</strong> ${rg}</p>
          <p><strong>Setor:</strong> ${setor}</p>
          <p><strong>Função:</strong> ${funcao}</p>
        `;
      } else {
        trabalhadorInfo = document.getElementById("trabalhador-info").innerHTML;
      }

      if (!data || !hora || !atendimento || !tipoAgendamento || !empresaInfo || !trabalhadorInfo) {
        alert("Preencha todos os dados obrigatórios.");
        return;
      }

      if (contatoTipo && !contato) {
        alert("Preencha o campo de contato.");
        return;
      }

      divResumo.innerHTML = `
        <div class="section">
          <h4>Empresa</h4>
          ${empresaInfo}
        </div>
        <div class="section">
          <h4>Trabalhador</h4>
          ${trabalhadorInfo}
        </div>
        <div class="section">
          <h4>Detalhes do Agendamento</h4>
          <p><strong>Data:</strong> ${new Date(data).toLocaleDateString()}</p>
          <p><strong>Horário:</strong> ${hora}</p>
          <p><strong>Tipo de Atendimento:</strong> ${atendimento}</p>
          <p><strong>Tipo de Agendamento:</strong> ${tipoAgendamento}</p>
          ${contatoTipo ? `<p><strong>Contato (${contatoTipo}):</strong> ${contato}</p>` : ''}
          <p><strong>Observações:</strong> ${observacoes || "Nenhuma"}</p>
        </div>
        <div style="width: 100%; text-align: center;">
          <button class="excluir-agendamento-btn" onclick="excluirAgendamento(this.parentNode.parentNode)">Excluir Agendamento</button>
        </div>
      `;
      divResumo.style.display = "block";
    }

    function excluirAgendamento(card) {
      if (confirm("Tem certeza que deseja excluir este agendamento?")) {
        card.remove();
        const listaAgendamentos = document.getElementById("lista-agendamentos").innerHTML;
        localStorage.setItem("listaAgendamentos", listaAgendamentos);
      }
    }

    function adicionarNovoAgendamento() {
      const resumo = document.getElementById("resumo");
      const lista = document.getElementById("lista-agendamentos");

      if (resumo.innerHTML.trim() !== "") {
        const novoResumo = document.createElement("div");
        novoResumo.className = "resumo";
        novoResumo.innerHTML = resumo.innerHTML;
        novoResumo.style.display = "block";
        lista.appendChild(novoResumo);
        localStorage.setItem("listaAgendamentos", lista.innerHTML);
      }

      document.getElementById("tipo-agendamento").value = "";
      document.getElementById("cpf").value = "";
      document.getElementById("nome").value = "";
      document.getElementById("cpf-admissional").value = "";
      document.getElementById("nascimento").value = "";
      document.getElementById("rg").value = "";
      document.getElementById("setor").value = "";
      document.getElementById("funcao").value = "";
      document.getElementById("observacoes").value = "";
      document.getElementById("data").value = "";
      document.getElementById("hora").value = "";
      document.getElementById("contatoTipo").value = "";
      document.getElementById("contato").value = "";
      document.getElementById("contato").style.display = "none";
      document.getElementById("tipo-atendimento").value = "";

      document.getElementById("form-admissional").style.display = "none";
      document.getElementById("trabalhador-info").style.display = "none";
      resumo.innerHTML = "";
      resumo.style.display = "none";
    }

    function enviarAgendamento() {
      // Limpa todos os campos de entrada
      document.getElementById("tipo-identificacao").value = "";
      document.getElementById("cnpj").value = "";
      document.getElementById("cei").value = "";
      document.getElementById("tipo-agendamento").value = "";
      document.getElementById("cpf").value = "";
      document.getElementById("nome").value = "";
      document.getElementById("cpf-admissional").value = "";
      document.getElementById("nascimento").value = "";
      document.getElementById("rg").value = "";
      document.getElementById("setor").value = "";
      document.getElementById("funcao").value = "";
      document.getElementById("observacoes").value = "";
      document.getElementById("data").value = "";
      document.getElementById("hora").value = "";
      document.getElementById("contatoTipo").value = "";
      document.getElementById("contato").value = "";
      document.getElementById("tipo-atendimento").value = "";

      // Oculta seções dinâmicas e limpa conteúdos
      document.getElementById("campo-cnpj").style.display = "none";
      document.getElementById("campo-cei").style.display = "none";
      document.getElementById("empresa-info").style.display = "none";
      document.getElementById("empresa-info").innerHTML = "";
      document.getElementById("form-admissional").style.display = "none";
      document.getElementById("trabalhador-info").style.display = "none";
      document.getElementById("trabalhador-info").innerHTML = "";
      document.getElementById("resumo").style.display = "none";
      document.getElementById("resumo").innerHTML = "";
      document.getElementById("lista-agendamentos").innerHTML = "";
      document.getElementById("contato").style.display = "none";

      // Limpa o localStorage
      localStorage.removeItem("listaAgendamentos");

      alert("Agendamento enviado com sucesso!\nAguardamos o seu Colaborador.");
    }

    function imprimirAgendamento() {
      const resumo = document.getElementById("resumo");
      const listaAgendamentos = document.getElementById("lista-agendamentos");
      const empresaInfo = document.getElementById("empresa-info");

      // Verifica se há conteúdo para imprimir
      const resumoContent = resumo.style.display === "block" ? resumo.innerHTML : "";
      const agendamentosContent = Array.from(listaAgendamentos.children)
        .filter(child => child.style.display !== "none")
        .map(child => child.innerHTML)
        .join('<hr style="border: 1px solid #3d7ebd; margin: 20px 0;">');

      if (!resumoContent && !agendamentosContent && !empresaInfo.innerHTML) {
        alert("Nenhum agendamento ou informação de empresa para imprimir.");
        return;
      }

      // Chama a janela de impressão padrão do navegador
      window.print();
    }
  </script>
</body>
</html>